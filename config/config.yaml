# Recommendation Service 配置文件
#
# 这是一个标准的微服务配置文件示例
# 在实际项目中，通常会：
# - 使用配置中心（如 Apollo、Nacos）
# - 支持环境变量覆盖
# - 支持多环境配置（dev、test、prod）

# 服务配置
server:
  name: recommendation-service
  version: 1.0.0
  port: 8888
  # 服务注册与发现
  registry:
    type: etcd  # 或 consul、nacos
    endpoints:
      - 127.0.0.1:2379
  # 链路追踪
  tracing:
    enabled: true
    endpoint: http://localhost:14268/api/traces
    sampler: 1.0  # 采样率

# 数据库配置
database:
  mysql:
    host: 127.0.0.1
    port: 3306
    user: root
    password: password
    database: recommendation
    charset: utf8mb4
    # 连接池配置
    max_idle_conns: 10
    max_open_conns: 100
    conn_max_lifetime: 3600  # 秒

# Redis 配置
redis:
  host: 127.0.0.1
  port: 6379
  password: ""
  db: 0
  # 连接池配置
  pool_size: 10
  min_idle_conns: 5

# RPC 客户端配置
rpc_clients:
  # User 服务
  user_service:
    name: user-service
    endpoints:
      - 127.0.0.1:8889
    timeout: 3000  # 毫秒
    retry: 2

  # Content 服务
  content_service:
    name: content-service
    endpoints:
      - 127.0.0.1:8890
    timeout: 3000
    retry: 2

# 业务配置
business:
  # 推荐配置
  recommendation:
    # 默认推荐数量
    default_limit: 10
    # 最大推荐数量
    max_limit: 50
    # 推荐有效期（天）
    expiry_days: 7
    # 最近关注天数
    recent_follow_days: 7
    # 最小推荐分数
    min_score: 10

# 日志配置
log:
  level: info  # debug, info, warn, error
  format: json  # json, text
  output: stdout  # stdout, file
  # 如果 output 是 file
  file:
    path: logs/recommendation.log
    max_size: 100  # MB
    max_backups: 10
    max_age: 30  # 天

# 监控配置
metrics:
  enabled: true
  port: 9090
  path: /metrics

# 限流配置
rate_limit:
  enabled: true
  # QPS 限制
  qps: 1000
  # 并发限制
  concurrency: 100

# 熔断配置
circuit_breaker:
  enabled: true
  # 错误率阈值
  error_threshold: 0.5
  # 最小请求数
  min_requests: 20
  # 熔断时间（秒）
  timeout: 60
